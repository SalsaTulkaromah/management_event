<!DOCTYPE html>
<html lang="id">
<head>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <meta charset="UTF-8">
  <title>Spin The Wheel</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- App favicon -->
  <link rel="shortcut icon" href="assets/images/logo-favicon.ico">
  <script src="assets/js/jquery.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="assets/js/jquery.min.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: url('assets/images/bg-spin.jpg') no-repeat center center fixed;
      background-size: cover;
      font-family: 'Segoe UI', sans-serif;
      position: relative;
      color: #333;
      overflow: hidden;
    }

    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      height: 100%;
      width: 100%;
      background: rgba(25, 35, 90, 0.85);
      z-index: 0;
    }

    .main-content {
      position: relative;
      z-index: 1;
      padding: 4rem 1rem;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .event-header {
      text-align: center;
      color: white;
      margin-bottom: 2rem;
    }

    .spin-container {
      background: white;
      border-radius: 1rem;
      padding: 4.5rem;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      text-align: center;
      max-width: 600px;
      width: 100%;
      margin-top: 1rem;
    }
  
    .spin-title {
      font-size: 2rem;
      font-weight: bold;
      color: #3f4f88;
      margin-bottom: 1.5rem;
    }
  
    #winnerName {
      font-size: 2.5rem;
      font-weight: bold;
      color: #000000;
      margin: 2.5rem 0;
      min-height: 60px;
      transition: all 0.3s ease;
    }
  
    #startBtn {
      background-color: #3f4f88;
      color: white;
      border: none;
      padding: 0.75rem 2rem;
      font-size: 1.2rem;
      border-radius: 0.5rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }
  
    #startBtn:hover {
      background-color: #FF0000;
      box-shadow: 0 4px 12px rgba(63, 79, 136, 0.4);
    }
  </style>

</head>
<body>
  <div class="overlay"></div>
    <div class="main-content">
      <div class="event-header">
        <img src="assets/images/logo-mix.png" alt="SINDIGI Logo" style="height: 60px;">
        <h1 id="nama_event">NAMA EVENT</h1>
        <p id="deskripsi_event"><em>"Description Event"</em></p>
        <p id="tanggal_event">üìÖ Tanggal | üïò Waktu | üìç Tempat</p>
      </div>

      <div class="spin-container">
        <div class="spin-title">DOOR PRIZE SESSION</div>
        <div class="winner-name" id="winnerName"></div>
        <button id="startBtn">START</button>
      </div>
    </div>
    
    <script>
      $(document).ready(function() {
        $.ajax({
          url: '/spin/getSpinPage',  // The API endpoint
          method: 'GET',
          success: function(data) {
            console.log("DATA DARI SERVER:", data);
            
            const participants = Array.isArray(data) ? data : data.participants; // Pastikan data yang diterima adalah array
            
            // Fungsi untuk mengacak array
            function shuffleArray(array) {
              for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]; // Tukar elemen
              }
              return array;
            }
        
            // Kocok nama peserta sebelum digunakan
            const shuffledParticipants = shuffleArray(participants);
        
            $('#startBtn').click(function() {
              const winnerDiv = $('#winnerName');
              let counter = 0;
              const interval = setInterval(function() {
                const randomIndex = Math.floor(Math.random() * shuffledParticipants.length);
                winnerDiv.text(shuffledParticipants[randomIndex]); // Menampilkan nama pemenang acak
                counter++;
                if (counter > 20) { // Spin 20 kali, kemudian berhenti
                  clearInterval(interval);
                  
                  // Menampilkan pemenang dengan SweetAlert
                  const winner = shuffledParticipants[randomIndex];
                  Swal.fire({
                    title: 'Selamat!',
                    text: `Pemenang adalah ${winner}`,
                    icon: 'success',
                    confirmButtonText: 'OK'
                  });
                }
              }, 100); // Update setiap 100ms
            });
          },
          error: function(err) {
            console.error('Error fetching participants:', err);
          }
        });
      });            
    </script> 
  </body>
</html> 