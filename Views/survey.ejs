<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Survei Kepuasan Peserta</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container my-5">
    <h2 class="mb-4">Formulir Survei Kepuasan</h2>

    <form id="surveyForm">
        <input type="hidden" name="participant_id" value="<%= participant.id %>">

        <h5>I. Informasi Umum Peserta</h5>
        <div class="mb-3">
            <label>Nama</label>
            <input type="text" class="form-control" name="name" value="<%= participant.name %>" required>
        </div>
        <div class="mb-3">
            <label>Email</label>
            <input type="email" class="form-control" name="email" value="<%= participant.email %>" required>
        </div>
        <div class="mb-3">
            <label>Instansi</label>
            <input type="text" class="form-control" name="institution" value="<%= participant.company_name %>" required>
        </div>

        <hr>
        <h5>II. Pertanyaan Survei Kepuasan (1 = Sangat Tidak Puas, 5 = Sangat Puas)</h5>

        <% function rating(name) { %>
            <div class="mb-3">
                <% for (let i = 1; i <= 5; i++) { %>
                    <label class="me-2">
                        <input type="radio" name="<%= name %>" value="<%= i %>" required> <%= i %>
                    </label>
                <% } %>
            </div>
        <% } %>

        <label>1. Kelengkapan & kejelasan materi:</label>
        <% rating('materi_kelengkapan') %>

        <label>2. Kesesuaian materi:</label>
        <% rating('materi_kesesuaian') %>

        <label>3. Wawasan/pengetahuan baru:</label>
        <% rating('materi_wawasan') %>

        <label>4. Penyampaian narasumber:</label>
        <% rating('penyampaian_jelas') %>

        <label>5. Kemampuan menjawab pertanyaan:</label>
        <% rating('penyampaian_diskusi') %>

        <label>6. Penjelasan fitur APM:</label>
        <% rating('pemahaman_fitur') %>

        <label>7. Pemahaman cara kerja APM:</label>
        <% rating('pemahaman_cara_kerja') %>

        <label>8. Demo & studi kasus:</label>
        <% rating('pemahaman_demo') %>

        <label>9. Rekomendasi penggunaan:</label>
        <% rating('rekomendasi_penggunaan') %>

        <label>10. Relevansi produk:</label>
        <% rating('relevansi_produk') %>

        <label>11. Kepuasan total terhadap event:</label>
        <% rating('kepuasan_total') %>

        <hr>
        <h5>III. Pertanyaan Tambahan</h5>
        <div class="mb-3">
            <label>Hal yang disukai dari event:</label>
            <textarea name="suka_dari_event" class="form-control"></textarea>
        </div>
        <div class="mb-3">
            <label>Saran atau masukan:</label>
            <textarea name="saran_event" class="form-control"></textarea>
        </div>
        <div class="mb-3">
            <label>Tertarik info/demo lebih lanjut?</label>
            <textarea name="tertarik_info_lanjutan" class="form-control"></textarea>
        </div>

        <button type="submit" class="btn btn-primary">Kirim Survei</button>
    </form>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
        document.getElementById('surveyForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const formData = new FormData(this);

            const res = await fetch('/survey/submit', {
                method: 'POST',
                body: new URLSearchParams([...formData])
            });

            const data = await res.json();
            if (data.success) {
                Swal.fire('Terima kasih!', 'Survei berhasil dikirim.', 'success');
                this.reset();
            } else {
                Swal.fire('Gagal', data.message || 'Gagal menyimpan survei.', 'error');
            }
        });
    </script>
</body>
</html>
